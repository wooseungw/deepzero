íŒŒì¼ì— ì§ì ‘ íŒ¨ì¹˜í•˜ëŠ” ê³¼ì •ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.
VS Codeì—ì„œ readme.MD ë¥¼ ì—¬ì‹  ë’¤, ì•„ë˜ ë§ˆí¬ë‹¤ìš´ì„ í†µì§¸ë¡œ ë®ì–´-ë¶™ì—¬ ì£¼ì„¸ìš”. (ê¸°ì¡´ ë‚´ìš©ì€ ì§€ì›Œë„ ë©ë‹ˆë‹¤.)

â¸»


# ğŸ“‘ ì»¤ìŠ¤í…€ ëª¨ë¸ YAML ê°€ì´ë“œ

> **DeepZero Model Builder** (`deepzero/core/model_builder.py`)ì—ì„œ ì‚¬ìš©í•  **YAML-ê¸°ë°˜ ë„¤íŠ¸ì›Œí¬ ì •ì˜ ë¬¸ë²•**ì„ ì„¤ëª…í•©ë‹ˆë‹¤.
>
> ```python
> from deepzero.core import model_builder
> net = model_builder.build_model_from_yaml("configs/my_model.yaml")
> ```
>
> ìœ„ì²˜ëŸ¼ í˜¸ì¶œí•˜ë©´ ê³§ë°”ë¡œ PyTorch `nn.Module` ê°ì²´ê°€ ìƒì„±ë©ë‹ˆë‹¤.

---

## 1. ì „ì²´ YAML ê³¨ê²©

```yaml
in_channels: 3          # (í•„ìˆ˜) ì…ë ¥ ì±„ë„ ìˆ˜
num_classes: 100        # (ì„ íƒ) ì „ì—­ ë³€ìˆ˜, ë¬¸ìì—´ ì¹˜í™˜ìš©
depth_multiple: 1.0     # (ì„ íƒ) ë ˆì´ì–´ ë°˜ë³µ ìŠ¤ì¼€ì¼
width_multiple: 1.0     # (ì„ íƒ) ì±„ë„  ìŠ¤ì¼€ì¼

layers:
  #   from  repeat  Block                      positional-argsâ€¦               kwargs
  - [  -1,     1,   ConvBlock,                 64, 3, 2,                      {act: relu, drop: 0.1} ]
  - [  -1,     2,   TransformerEncoderBlock,   128, 4, 8 ]
  - [  -1,     1,   GlobalAvgPool ]
  - [  -1,     1,   LinearBlock,               num_classes,                  {norm: ln} ]
```
## í•„ë“œ ì„¤ëª…
### from	
ì…ë ¥ìœ¼ë¡œ ì‚¼ì„ ì´ì „ ë ˆì´ì–´ ì¸ë±ìŠ¤ (-1 = ì§ì „, -2 = ë‘ ë‹¨ê³„ ì „)
### repeat	
ë¸”ë¡ ë°˜ë³µ íšŸìˆ˜ (depth_multipleê°€ ê³±í•´ì§„ ë’¤ ë°˜ì˜¬ë¦¼)
### Block	
``` ConvBlock, LinearBlock, TransformerEncoderBlock, GlobalAvgPool ë˜ëŠ” ì§ì ‘ êµ¬í˜„í•œ ë¸”ë¡ ```

positional args	ë¸”ë¡ë³„ í•„ìˆ˜ ì¸ì  
â€¢ ConvBlock â†’ out_channels, kernel, stride  â€¢ LinearBlock â†’ out_features  â€¢ TransformerEncoderBlock â†’ dim, heads, mlp_ratio
kwargs	ì„ íƒ : act, norm, drop ë“± ê³µí†µ í•˜ì´í¼íŒŒë¼ë¯¸í„°


â¸»

2. ê³µí†µ í•˜ì´í¼íŒŒë¼ë¯¸í„°

ì˜µì…˜	ê°’	ì ìš© ë¸”ë¡	ê¸°ë³¸ê°’
act	silu, relu, gelu, tanh, identity	Conv / Linear	silu
norm	bn, ln, gn, none(null)	Conv(2D) / Linear(1D)	bn
drop	0 ~ 1 (í™•ë¥ )	Conv â†’ Dropout2d, Linear â†’ Dropout	0

{act: gelu, norm: gn, drop: 0.25}


â¸»

3. ì§€ì› ë¸”ë¡ & ì‹œê·¸ë‹ˆì²˜

ë¸”ë¡	ìƒì„±ì ì„œëª…	ì„¤ëª…
ConvBlock	c_in, c_out, k, s, *, act, norm, drop	Same-padding 2D Conv
LinearBlock	_dummy, out_features, *, act, norm, drop	Flatten â†’ Linear
TransformerEncoderBlock	dim, heads, mlp_ratio	ViT-style ì¸ì½”ë” (ì¶œë ¥ 4-D ë³µê·€)
GlobalAvgPool	â€“	(B,C,H,W) â†’ (B,C)

ìƒˆ ë¸”ë¡ì„ ì¶”ê°€í•˜ë ¤ë©´

class MyBlock(BlockBase):
    ...

ì²˜ëŸ¼ ì •ì˜í•˜ë©´ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ìë™ ë“±ë¡ë©ë‹ˆë‹¤.

â¸»

4. ì „ì—­ ë³€ìˆ˜ ì¹˜í™˜

num_classes: 5
layers:
  - [ -1, 1, LinearBlock, num_classes ]   # â‡’ out_features = 5


â¸»

5. ì˜ˆì‹œ â€“ Tiny ViT Classifier

# tiny_vit.yaml
in_channels: 3
num_classes: 10
depth_multiple: 1.0
width_multiple: 0.5   # ì±„ë„ ì ˆë°˜

layers:
- [ -1, 1, ConvBlock, 64, 7, 2 ]                         # 112Ã—112
- [ -1, 1, ConvBlock, 128, 3, 2,   {drop: 0.1} ]
- [ -1, 2, TransformerEncoderBlock, 128, 4, 4 ]
- [ -1, 1, ConvBlock, 256, 3, 2 ]
- [ -1, 1, GlobalAvgPool ]
- [ -1, 1, LinearBlock, 512,          {act: relu} ]
- [ -1, 1, LinearBlock, num_classes,  {act: identity, norm: none} ]


â¸»

6. ê³ ê¸‰ íŒ

ëª©ì 	ë°©ë²•
ê¹Šì´Â·í­ ìŠ¤ì¼€ì¼	depth_multiple, width_multiple ê°’ ì¡°ì •
Dropout OFF	drop: 0 ë˜ëŠ” ìƒëµ
BatchNorm ì—†ëŠ” Conv	{norm: none}
LayerNorm Conv	{norm: ln} (GroupNorm 1 ê·¸ë£¹ í™œìš©)
ë°˜ë³µ ë¸”ë¡ë³„ ë‹¤ë¥¸ Act	ë°˜ë³µì„ ë‚˜ëˆ  ë³„ë„ ë ˆì´ì–´ë¡œ ì„ ì–¸


â¸»

7. ìì£¼ ë‚˜ëŠ” ì˜¤ë¥˜ & í•´ê²°

ì˜¤ë¥˜	ì›ì¸ / í•´ê²°
expected 4D input (got 3D)	Transformer ë’¤ Conv ë°°ì¹˜ì—ì„œ 3-D ì „ë‹¬ â†’ ë ˆì´ì–´ ìˆœì„œÂ·ì±„ë„ í™•ì¸
BlockBase.registry KeyError	YAML Block ì´ë¦„ì´ ì‹¤ì œ í´ë˜ìŠ¤ì™€ ë‹¤ë¦„
Lì´ ì •ì‚¬ê° ê²©ìì— ëŒ€ì‘ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤	Transformer í† í° ìˆ˜ê°€ ì œê³±ìˆ˜ê°€ ì•„ë‹˜ â†’ ì…ë ¥ í•´ìƒë„Â·stride ì ê²€


â¸»

8. ë¹Œë“œ & í…ŒìŠ¤íŠ¸ ìŠ¤ë‹ˆí«

import torch
from deepzero.core import model_builder

net = model_builder.build_model_from_yaml("configs/tiny_vit.yaml")
x   = torch.randn(1, 3, 224, 224)

print(net(x).shape)                      # torch.Size([1, 10])
print("params:", sum(p.numel() for p in net.parameters()) / 1e6, "M")


â¸»

ì´ ê°€ì´ë“œë¥¼ ì°¸ê³ í•˜ì—¬ ììœ ë¡­ê²Œ YAMLì„ í¸ì§‘í•˜ë©° ë‚˜ë§Œì˜ ëª¨ë¸ì„ ì„¤ê³„í•´ ë³´ì„¸ìš”!
